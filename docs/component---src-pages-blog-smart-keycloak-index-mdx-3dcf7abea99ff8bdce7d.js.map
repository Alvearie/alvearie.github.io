{"version":3,"sources":["webpack:///./node_modules/gatsby-theme-carbon/src/components/PageHeader/index.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/PageHeader/PageHeader.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/EditLink/index.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/EditLink/EditLink.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/PageTabs/index.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/PageTabs/PageTabs.js","webpack:///./node_modules/gatsby-theme-carbon/src/templates/Default.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/EditLink/EditLink.module.scss","webpack:///./src/pages/blog/smart-keycloak/index.mdx","webpack:///./node_modules/gatsby-theme-carbon/src/components/PageTabs/PageTabs.module.scss","webpack:///./node_modules/gatsby-theme-carbon/src/components/PageHeader/PageHeader.module.scss"],"names":["PageHeader","title","theme","tabs","className","cx","styles","pageHeader","withTabs","length","darkMode","id","text","EditLink","relativePagePath","repositoryProp","repository","useStaticQuery","site","siteMetadata","baseUrl","subDirectory","href","branch","row","link","PageTabs","render","this","props","slug","currentTab","split","filter","Boolean","slice","pageTabs","map","tab","slugifiedTab","slugify","lower","strict","selected","currentTabRegex","RegExp","replace","key","selectedItem","listItem","to","tabsContainer","aria-label","list","React","Component","Default","pageContext","children","location","Title","frontmatter","titleType","frontmatterTheme","description","keywords","interiorTheme","useMetadata","pathPrefix","pathname","Layout","homepage","pageTitle","pageDescription","pageKeywords","label","Main","padded","NextPrevious","Utils","module","exports","_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","mdxType","parentName","isMDXComponent"],"mappings":"sOAEeA,ECGI,SAAC,GAAD,MAAGC,EAAH,EAAGA,MAAOC,EAAV,EAAUA,MAAV,IAAiBC,YAAjB,MAAwB,GAAxB,SACjB,mBACEC,UAAWC,IAAGC,IAAOC,YAAR,OACVD,IAAOE,UAAWL,EAAKM,OADb,EAEVH,IAAOI,UAAqB,SAAVR,EAFR,KAIb,mBAAKE,UAAU,YACb,mBAAKA,UAAU,WACb,mBAAKA,UAAU,iBACb,kBAAIO,GAAG,aAAaP,UAAWE,IAAOM,MACnCX,Q,YCbEY,ECIE,SAAC,GAAsD,IAApDC,EAAmD,EAAnDA,iBAA8BC,EAAqB,EAAjCC,WAGhBA,EAEhBC,yBAAe,cAHjBC,KACEC,aAAgBH,WAHiD,EAmB3BD,GAAkBC,EAApDI,EAnB6D,EAmB7DA,QAASC,EAnBoD,EAmBpDA,aAEXC,EAAUF,EAAN,SArB2D,EAmBtCG,OAEUF,EAA/B,aAAwDP,EAElE,OAAOM,EACL,mBAAKhB,UAAS,WAAaoB,OACzB,mBAAKpB,UAAU,WACb,iBAAGA,UAAWqB,OAAMH,KAAMA,GAA1B,8BAKF,M,oCCnCSI,E,kGCabC,OAAA,WAAU,IAAD,EACuBC,KAAKC,MAA3B5B,EADD,EACCA,MAAOE,EADR,EACQA,KAAM2B,EADd,EACcA,KACfC,EAAaD,EAAKE,MAAM,KAAKC,OAAOC,SAASC,OAAO,GAAG,GAEvDC,EAAWjC,EAAKkC,KAAI,SAACC,GAAS,IAAD,EAC3BC,EAAeC,IAAQF,EAAK,CAAEG,OAAO,EAAMC,QAAQ,IACnDC,EAAWJ,IAAiBR,EAG5Ba,EAAkB,IAAIC,OAAUd,EAAd,aAClBT,EAAOQ,EAAKgB,QAAQF,EAAiBL,GAC3C,OACE,kBAAIQ,IAAKT,EAAKlC,UAAWC,KAAE,OAAI2C,gBAAeL,EAAnB,GAA+BM,aACxD,YAAC,OAAD,CAAM7C,UAAWqB,OAAMyB,GAAE,GAAK5B,GAC3BgB,OAMT,OACE,mBAAKlC,UAAW+C,iBACd,mBAAK/C,UAAU,YACb,mBAAKA,UAAU,WACb,mBAAKA,UAAU,mCACb,mBAAKgD,aAAYnD,GACf,kBAAIG,UAAWiD,QAAOjB,S,GA3BAkB,IAAMC,W,wBC8E7BC,IA/EC,SAAC,GAAgD,IAA9CC,EAA6C,EAA7CA,YAAaC,EAAgC,EAAhCA,SAAUC,EAAsB,EAAtBA,SAAUC,EAAY,EAAZA,MAAY,EACJH,EAAlDI,mBADsD,MACxC,GADwC,EACpC/C,EAAgC2C,EAAhC3C,iBAAkBgD,EAAcL,EAAdK,UAE1C3D,EAKE0D,EALF1D,KACAF,EAIE4D,EAJF5D,MACO8D,EAGLF,EAHF3D,MACA8D,EAEEH,EAFFG,YACAC,EACEJ,EADFI,SAGMC,EAAkBC,cAAlBD,cAIEE,EACNnD,yBAAe,cADjBC,KAAQkD,WAUJtC,EAAOsC,EACTT,EAASU,SAASvB,QAAQsB,EAAY,IACtCT,EAASU,SAUPtC,EAPC5B,EAEH2B,EAAKE,MAAM,KAAKC,OAAOC,SAASC,OAAO,GAAG,IAC1CK,IAAQrC,EAAK,GAAI,CAAEsC,OAAO,IAHV,GASdvC,EAAQ6D,GAAoBG,EAElC,OACE,YAACI,EAAA,EAAD,CACEnE,KAAMA,EACNoE,UAAU,EACVrE,MAAOA,EACPsE,UAAWvE,EACXwE,gBAAiBT,EACjBU,aAAcT,EACdH,UAAWA,GACX,YAAC,EAAD,CACE7D,MAAO2D,EAAQ,YAACA,EAAD,MAAY3D,EAC3B0E,MAAM,QACNxE,KAAMA,EACND,MAAOA,IAERC,GACC,YAAC,EAAD,CACEF,MAAOA,EACP6B,KAAMA,EACN3B,KAAMA,EACN4B,WAAYA,IAGhB,YAAC6C,EAAA,EAAD,CAAMC,QAAM,GACTnB,EACD,YAAC,EAAD,CAAU5C,iBAAkBA,KAE9B,YAACgE,EAAA,EAAD,CACErB,YAAaA,EACbE,SAAUA,EACV7B,KAAMA,EACN3B,KAAMA,EACN4B,WAAYA,IAEd,YAACgD,EAAA,EAAD,S,qBCtFNC,EAAOC,QAAU,CAAC,kBAAoB,iDAAiD,oBAAsB,mDAAmD,KAAO,+BAA+B,IAAM,gC,8LCO/LC,G,UAAe,IACtBC,EAAc,CAClBD,gBAEIE,EAAYC,IACH,SAASC,EAAT,GAGZ,IAFDC,EAEC,EAFDA,WACG1D,EACF,8BACD,OAAO,YAACuD,EAAD,eAAeD,EAAiBtD,EAAhC,CAAuC0D,WAAYA,EAAYC,QAAQ,cAG5E,6FACA,oCACA,4BAAW,6BAAGC,WAAW,KAAQ,CAC7B,KAAQ,+BADD,mBAAX,eAE4C,6BAAGA,WAAW,KAAQ,CAC9D,KAAQ,gCADgC,+BAF5C,yFAMA,qLAEA,qBAAG,6BAAGA,WAAW,KAAQ,CACrB,KAAQ,mCADT,iBAAH,yNAG6G,6BAAGA,WAAW,KAAQ,CAC/H,KAAQ,8CADiG,8BAH7G,uDAM+C,0BAAYA,WAAW,KAAvB,UAN/C,sBAMwH,0BAAYA,WAAW,KAAvB,kBANxH,KAOA,8BAAa,kBAAIA,WAAW,KAAf,UAAb,2LAC6D,0BAAYA,WAAW,KAAvB,yCAD7D,WAEA,sBACE,kBAAIA,WAAW,MAAK,kBAAIA,WAAW,MAAf,WAApB,OAAgE,0BAAYA,WAAW,MAAvB,WAAhE,OAA4H,0BAAYA,WAAW,MAAvB,QAA5H,KACA,kBAAIA,WAAW,MAAK,kBAAIA,WAAW,MAAf,gBAApB,2EAAyI,0BAAYA,WAAW,MAAvB,KAAzI,wCACA,kBAAIA,WAAW,MAAK,kBAAIA,WAAW,MAAf,cAApB,OAAmE,0BAAYA,WAAW,MAAvB,QAAnE,OAA4H,0BAAYA,WAAW,MAAvB,SAA5H,QAAuL,0BAAYA,WAAW,MAAvB,KAAvL,yBAEF,8BAAa,kBAAIA,WAAW,KAAf,kBAAb,qRAEA,uHAAsG,6BAAGA,WAAW,KAAQ,CACxH,KAAQ,6BAD0F,YAAtG,8DAIA,+EACA,8HACuC,kBAAIA,WAAW,KAAf,UADvC,iHAEwB,kBAAIA,WAAW,KAAf,kBAFxB,0BAGA,0FAAyE,kBAAIA,WAAW,KAAf,oBAAzE,kBAAwI,6BAAGA,WAAW,KAAQ,CAC1J,KAAQ,gIAD4H,6BAAxI,qCAE4E,0BAAYA,WAAW,KAAvB,WAF5E,+DAE+L,0BAAYA,WAAW,KAAvB,WAF/L,0EAGA,yFAAwE,0BAAYA,WAAW,KAAvB,OAAxE,8CAAsK,6BAAGA,WAAW,KAAQ,CACxL,KAAQ,gFAD0J,iBAAtK,2HAEsJ,6BAAGA,WAAW,KAAQ,CACxK,KAAQ,yHAD0I,wHAFtJ,sFAIwN,0BAAYA,WAAW,KAAvB,OAJxN,uCAKA,mPAAkO,6BAAGA,WAAW,KAAQ,CACpP,KAAQ,6DADsN,uBAAlO,0BAGA,yEACA,uGACA,sBACE,kBAAIA,WAAW,MAAK,kBAAIA,WAAW,MAAf,mBAApB,kHACA,kBAAIA,WAAW,MAAK,kBAAIA,WAAW,MAAf,uBAApB,mGACE,kBAAIA,WAAW,MACb,kBAAIA,WAAW,MAAf,8DAAmF,0BAAYA,WAAW,MAAvB,OAAnF,6DACA,kBAAIA,WAAW,MAAf,0JAIN,+CACA,sBACE,kBAAIA,WAAW,MAAf,2EAAgG,6BAAGA,WAAW,MAAS,CACnH,KAAQ,gGACP,0BAAYA,WAAW,KAAvB,2BAFL,4CAGE,kBAAIA,WAAW,MACb,kBAAIA,WAAW,MAAf,oFAGJ,kBAAIA,WAAW,MAAf,oGAAyH,0BAAYA,WAAW,MAAvB,mBAAzH,YACE,kBAAIA,WAAW,MACb,kBAAIA,WAAW,MAAf,qDAA0E,0BAAYA,WAAW,MAAvB,mBAA1E,kDAAyL,0BAAYA,WAAW,MAAvB,YAAzL,6NACR,+BAAKA,WAAW,MAAS,CACb,IAAO,uGACP,IAAO,8BAEX,kBAAIA,WAAW,MAAf,OAA4B,0BAAYA,WAAW,MAAvB,mBAA5B,oBAA6G,sBAAQA,WAAW,MAAnB,OAA7G,sGAA4P,0BAAYA,WAAW,MAAvB,gDAA5P,kBAAwW,0BAAYA,WAAW,MAAvB,kBAAxW,yDAA6d,0BAAYA,WAAW,MAAvB,cAA7d,6BACR,+BAAKA,WAAW,MAAS,CACb,IAAO,uGACP,IAAO,0BAIf,kBAAIA,WAAW,MAAf,yBAA8C,kBAAIA,WAAW,MAAf,uBAA9C,qDACJ,+BAAKA,WAAW,MAAS,CACjB,IAAO,uGACP,IAAO,gCAEX,kBAAIA,WAAW,MAAf,4GACJ,+BAAKA,WAAW,MAAS,CACjB,IAAO,uGACP,IAAO,sBAGb,yDACA,sIAC2B,6BAAGA,WAAW,KAAQ,CAC7C,KAAQ,sGADe,6BAD3B,wGAG+I,0BAAYA,WAAW,KAAvB,oCAH/I,iDAG6Q,0BAAYA,WAAW,KAAvB,4BAH7Q,KAIA,uBAAK,gCAAMA,WAAW,OAAU,CAC5B,UAAa,iBADZ,08CAmCL,iHAAgG,6BAAGA,WAAW,KAAQ,CAClH,KAAQ,8EADoF,cAAhG,+DAEuF,0BAAYA,WAAW,KAAvB,WAFvF,qDAGA,oHAAmG,0BAAYA,WAAW,KAAvB,YAAnG,mBAA2K,0BAAYA,WAAW,KAAvB,2BAA3K,wBAAuQ,6BAAGA,WAAW,KAAQ,CACzR,KAAQ,oHAD2P,gCAAvQ,KAGA,uBAAK,gCAAMA,WAAW,OAAU,CAC5B,UAAa,kBADZ,k9DA4DL,oCACA,wRACA,iYAAgX,6BAAGA,WAAW,KAAQ,CAClY,KAAQ,2FADoW,iBAAhX,SAEoC,6BAAGA,WAAW,KAAQ,CACtD,KAAQ,6DADwB,wCAFpC,YAI8D,6BAAGA,WAAW,KAAQ,CAChF,KAAQ,gCADkD,2BAJ9D,kDAOA,uBACA,igBAG8H,6BAAGA,WAAW,KAAQ,CAChJ,KAAQ,8BADkH,6BAH9H,MAUJH,EAAWI,gBAAiB,G,qBC3O5BV,EAAOC,QAAU,CAAC,kBAAoB,iDAAiD,oBAAsB,mDAAmD,cAAgB,yCAAyC,KAAO,+BAA+B,SAAW,oCAAoC,KAAO,+BAA+B,aAAe,0C,qBCAnWD,EAAOC,QAAU,CAAC,kBAAoB,mDAAmD,oBAAsB,qDAAqD,WAAa,wCAAwC,SAAW,sCAAsC,SAAW,sCAAsC,KAAO","file":"component---src-pages-blog-smart-keycloak-index-mdx-3dcf7abea99ff8bdce7d.js","sourcesContent":["import PageHeader from './PageHeader';\n\nexport default PageHeader;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\nimport styles from './PageHeader.module.scss';\n\nconst PageHeader = ({ title, theme, tabs = [] }) => (\n  <div\n    className={cx(styles.pageHeader, {\n      [styles.withTabs]: tabs.length,\n      [styles.darkMode]: theme === 'dark',\n    })}>\n    <div className=\"bx--grid\">\n      <div className=\"bx--row\">\n        <div className=\"bx--col-lg-12\">\n          <h1 id=\"page-title\" className={styles.text}>\n            {title}\n          </h1>\n        </div>\n      </div>\n    </div>\n  </div>\n);\n\nPageHeader.propTypes = {\n  /**\n   * Specify the title for the page\n   */\n  title: PropTypes.node,\n};\n\nexport default PageHeader;\n","import EditLink from './EditLink';\n\nexport default EditLink;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { graphql, useStaticQuery } from 'gatsby';\n\nimport { link, row } from './EditLink.module.scss';\n\nconst EditLink = ({ relativePagePath, repository: repositoryProp }) => {\n  const {\n    site: {\n      siteMetadata: { repository },\n    },\n  } = useStaticQuery(graphql`\n    query REPOSITORY_QUERY {\n      site {\n        siteMetadata {\n          repository {\n            baseUrl\n            subDirectory\n            branch\n          }\n        }\n      }\n    }\n  `);\n\n  const { baseUrl, subDirectory, branch } = repositoryProp || repository;\n\n  const href = `${baseUrl}/edit/${branch}${subDirectory}/src/pages${relativePagePath}`;\n\n  return baseUrl ? (\n    <div className={`bx--row ${row}`}>\n      <div className=\"bx--col\">\n        <a className={link} href={href}>\n          Edit this page on GitHub\n        </a>\n      </div>\n    </div>\n  ) : null;\n};\n\nEditLink.propTypes = {\n  repository: PropTypes.shape({\n    baseUrl: PropTypes.string,\n    subDirectory: PropTypes.string,\n    branch: PropTypes.string,\n  }),\n  relativePagePath: PropTypes.string,\n};\n\nexport default EditLink;\n","import PageTabs from './PageTabs';\n\nexport default PageTabs;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from 'gatsby';\nimport slugify from 'slugify';\nimport cx from 'classnames';\n\nimport {\n  tabsContainer,\n  list,\n  selectedItem,\n  listItem,\n  link,\n} from './PageTabs.module.scss';\n\nexport default class PageTabs extends React.Component {\n  render() {\n    const { title, tabs, slug } = this.props;\n    const currentTab = slug.split('/').filter(Boolean).slice(-1)[0];\n\n    const pageTabs = tabs.map((tab) => {\n      const slugifiedTab = slugify(tab, { lower: true, strict: true });\n      const selected = slugifiedTab === currentTab;\n      // matches with or without trailing slash: /?\n      // matches with or without hash link: (#.*)?\n      const currentTabRegex = new RegExp(`${currentTab}/?(#.*)?$`);\n      const href = slug.replace(currentTabRegex, slugifiedTab);\n      return (\n        <li key={tab} className={cx({ [selectedItem]: selected }, listItem)}>\n          <Link className={link} to={`${href}`}>\n            {tab}\n          </Link>\n        </li>\n      );\n    });\n\n    return (\n      <div className={tabsContainer}>\n        <div className=\"bx--grid\">\n          <div className=\"bx--row\">\n            <div className=\"bx--col-lg-12 bx--col-no-gutter\">\n              <nav aria-label={title}>\n                <ul className={list}>{pageTabs}</ul>\n              </nav>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nPageTabs.propTypes = {\n  tabs: PropTypes.array,\n  slug: PropTypes.string,\n};\n","import React from 'react';\nimport slugify from 'slugify';\nimport { useStaticQuery, graphql } from 'gatsby';\n\nimport Utils from '../components/Utils';\nimport Layout from '../components/Layout';\nimport PageHeader from '../components/PageHeader';\nimport EditLink from '../components/EditLink';\nimport NextPrevious from '../components/NextPrevious';\nimport PageTabs from '../components/PageTabs';\nimport Main from '../components/Main';\nimport useMetadata from '../util/hooks/useMetadata';\n\nconst Default = ({ pageContext, children, location, Title }) => {\n  const { frontmatter = {}, relativePagePath, titleType } = pageContext;\n  const {\n    tabs,\n    title,\n    theme: frontmatterTheme,\n    description,\n    keywords,\n  } = frontmatter;\n\n  const { interiorTheme } = useMetadata();\n\n  // get the path prefix if it exists\n  const {\n    site: { pathPrefix },\n  } = useStaticQuery(graphql`\n    query PATH_PREFIX_QUERY {\n      site {\n        pathPrefix\n      }\n    }\n  `);\n\n  // let gatsby handle prefixing\n  const slug = pathPrefix\n    ? location.pathname.replace(pathPrefix, '')\n    : location.pathname;\n\n  const getCurrentTab = () => {\n    if (!tabs) return '';\n    return (\n      slug.split('/').filter(Boolean).slice(-1)[0] ||\n      slugify(tabs[0], { lower: true })\n    );\n  };\n\n  const currentTab = getCurrentTab();\n\n  const theme = frontmatterTheme || interiorTheme;\n\n  return (\n    <Layout\n      tabs={tabs}\n      homepage={false}\n      theme={theme}\n      pageTitle={title}\n      pageDescription={description}\n      pageKeywords={keywords}\n      titleType={titleType}>\n      <PageHeader\n        title={Title ? <Title /> : title}\n        label=\"label\"\n        tabs={tabs}\n        theme={theme}\n      />\n      {tabs && (\n        <PageTabs\n          title={title}\n          slug={slug}\n          tabs={tabs}\n          currentTab={currentTab}\n        />\n      )}\n      <Main padded>\n        {children}\n        <EditLink relativePagePath={relativePagePath} />\n      </Main>\n      <NextPrevious\n        pageContext={pageContext}\n        location={location}\n        slug={slug}\n        tabs={tabs}\n        currentTab={currentTab}\n      />\n      <Utils />\n    </Layout>\n  );\n};\n\nexport default Default;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"bxTextTruncateEnd\":\"EditLink-module--bx--text-truncate--end--2EvBK\",\"bxTextTruncateFront\":\"EditLink-module--bx--text-truncate--front--5mCgN\",\"link\":\"EditLink-module--link--QlquD\",\"row\":\"EditLink-module--row--104Au\"};","import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\n\nimport DefaultLayout from \"C:/Alvearie/alvearie.github.io/node_modules/gatsby-theme-carbon/src/templates/Default.js\";\nexport const _frontmatter = {};\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <p>{`By Lee Surprenant `}{` `}{` `}{` | `}{` `}{` `}{` Published March 23, 2021`}</p>\n    <h3>{`Background`}</h3>\n    <p>{`The `}<a parentName=\"p\" {...{\n        \"href\": \"https://ibm.github.io/FHIR\"\n      }}>{`IBM FHIR Server`}</a>{` implements `}<a parentName=\"p\" {...{\n        \"href\": \"https://www.hl7.org/fhir/R4\"\n      }}>{`HL7 FHIR version 4.0.1 (R4)`}</a>{` and supports the\nFHIR REST API for each resource type defined in the specification.`}</p>\n    <p>{`However, one thing that neither the HL7 FHIR specification nor the IBM FHIR Server prescribe is the security model for this interface.\nEnter SMART on FHIR.`}</p>\n    <p><a parentName=\"p\" {...{\n        \"href\": \"https://docs.smarthealthit.org\"\n      }}>{`SMART on FHIR`}</a>{` is a collection of specifications that focus on authentication and authorization on top of HL7 FHIR.\nIn November of 2018, Boston Children’s Hospital and HL7 published the first of these specifications called the `}<a parentName=\"p\" {...{\n        \"href\": \"http://www.hl7.org/fhir/smart-app-launch/\"\n      }}>{`SMART App Launch Framework`}</a>{`.\nThis specification extends OAuth 2.0 with custom `}<inlineCode parentName=\"p\">{`scopes`}</inlineCode>{` and the notion of `}<inlineCode parentName=\"p\">{`launch context`}</inlineCode>{`.`}</p>\n    <p>{`SMART `}<em parentName=\"p\">{`scopes`}</em>{` are normal OAuth 2.0 scope strings that are used to define an authorization model that is aligned with FHIR resources.\nThe specification defines the scope strings via a pattern like `}<inlineCode parentName=\"p\">{`<context>/<resourceType>.<permission>`}</inlineCode>{`, where`}</p>\n    <ul>\n      <li parentName=\"ul\"><em parentName=\"li\">{`context`}</em>{` is `}<inlineCode parentName=\"li\">{`patient`}</inlineCode>{` or `}<inlineCode parentName=\"li\">{`user`}</inlineCode>{`;`}</li>\n      <li parentName=\"ul\"><em parentName=\"li\">{`resourceType`}</em>{` is one of the resource types defined in the HL7 FHIR specification, or `}<inlineCode parentName=\"li\">{`*`}</inlineCode>{` to indicate all resource types; and`}</li>\n      <li parentName=\"ul\"><em parentName=\"li\">{`permission`}</em>{` is `}<inlineCode parentName=\"li\">{`read`}</inlineCode>{` or `}<inlineCode parentName=\"li\">{`write`}</inlineCode>{`, or `}<inlineCode parentName=\"li\">{`*`}</inlineCode>{` for read and write.`}</li>\n    </ul>\n    <p>{`SMART `}<em parentName=\"p\">{`launch context`}</em>{` is what allows a user to launch an application in the context of a given user session or patient record.\nSMART App Launch defines two different launch varieties: one for launching apps from an Electronic Health Record (EHR) system and one for launching “standalone” apps.`}</p>\n    <p>{`In this post, I walk through how to support standalone app launch with the IBM FHIR Server via `}<a parentName=\"p\" {...{\n        \"href\": \"https://www.keycloak.org\"\n      }}>{`Keycloak`}</a>{`,\nan open source identity and access management solution.`}</p>\n    <h3>{`Introducing the Alvearie Keycloak Extensions for FHIR`}</h3>\n    <p>{`Keycloak is wonderfully extensible and easily configurable.\nUsers can automate the creation of SMART `}<em parentName=\"p\">{`scopes`}</em>{` through scipting or configuration, or manually create them via the admin console.\nHowever, supporting SMART `}<em parentName=\"p\">{`launch context`}</em>{` is a bit more tricky.`}</p>\n    <p>{`In particular, SMART extends the OAuth 2.0 / OpenID Connect token `}<em parentName=\"p\">{`response payload`}</em>{` with a set of `}<a parentName=\"p\" {...{\n        \"href\": \"http://www.hl7.org/fhir/smart-app-launch/scopes-and-launch-context/index.html#launch-context-arrives-with-your-access_token\"\n      }}>{`launch context parameters`}</a>{`. For example, in the case of the `}<inlineCode parentName=\"p\">{`patient`}</inlineCode>{` context, a SMART-enabled client application would expect a `}<inlineCode parentName=\"p\">{`patient`}</inlineCode>{` parameter in the token response payload (alongside the access token).`}</p>\n    <p>{`In addition to the above, SMART App Launch also defines a custom `}<inlineCode parentName=\"p\">{`aud`}</inlineCode>{` parameter that clients must pass on their `}<a parentName=\"p\" {...{\n        \"href\": \"http://www.hl7.org/fhir/smart-app-launch/#step-1-app-asks-for-authorization\"\n      }}>{`authorization`}</a>{` request (in addition to the fields required by OAuth 2.0 / OpenID Connect). Per the SMART “best practices” document at `}<a parentName=\"p\" {...{\n        \"href\": \"http://docs.smarthealthit.org/authorization/best-practices/#25-access-token-phishing-by-counterfeit-resource-servers\"\n      }}>{`http://docs.smarthealthit.org/authorization/best-practices/#25-access-token-phishing-by-counterfeit-resource-servers`}</a>{`, authorization servers should validate this field and use this same value for the `}<inlineCode parentName=\"p\">{`aud`}</inlineCode>{` claim in the granted access token.`}</p>\n    <p>{`Neither of these OAuth extensions are supported by Keycloak out-of-the-box (nor almost any other commercial Authorization server) and, for these reasons, the IBM team behind the IBM FHIR Server have introduced a set of `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/Alvearie/keycloak-extensions-for-fhir\"\n      }}>{`Keycloak extensions`}</a>{` that fill these gaps.`}</p>\n    <h3>{`Using the Alvearie Keycloak Extensions for FHIR`}</h3>\n    <p>{`The Keycloak extensions for FHIR project currently consists of two components:`}</p>\n    <ul>\n      <li parentName=\"ul\"><em parentName=\"li\">{`keycloak-config`}</em>{` for automating the configuration of a Keycloak realm in support of standalone app launch with patient context`}</li>\n      <li parentName=\"ul\"><em parentName=\"li\">{`keycloak-extensions`}</em>{` which defines a set of extensions that fill the gaps in Keycloak’s support of SMART App Launch:`}\n        <ul parentName=\"li\">\n          <li parentName=\"ul\">{`an AudienceValidator authenticator for validating that the `}<inlineCode parentName=\"li\">{`aud`}</inlineCode>{` parameter passed to the server matches the desired value`}</li>\n          <li parentName=\"ul\">{`a UserAttributeMapper mapper for mapping user attributes into custom fields in the token response payload (rather than claims in the issued tokens)`}</li>\n        </ul>\n      </li>\n    </ul>\n    <p>{`To use the extensions:`}</p>\n    <ol>\n      <li parentName=\"ol\">{`Build the keycloak-extensions project into a jar file and add it to the `}<a parentName=\"li\" {...{\n          \"href\": \"https://www.keycloak.org/docs/latest/server_development/#packaging-classes-and-deployment-2\"\n        }}><inlineCode parentName=\"a\">{`standalone/deployments`}</inlineCode></a>{` directory of your Keycloak installation.`}\n        <ul parentName=\"li\">\n          <li parentName=\"ul\">{`Note: moving forward, we hope to publish the built artifacts to Maven Central.`}</li>\n        </ul>\n      </li>\n      <li parentName=\"ol\">{`Configure a realm in your Keycloak installation for SMART App Launch, either manually or via the `}<inlineCode parentName=\"li\">{`keycloak-config`}</inlineCode>{` project.`}\n        <ul parentName=\"li\">\n          <li parentName=\"ul\">{`In addition to defining all the SMART scopes, the `}<inlineCode parentName=\"li\">{`keycloak-config`}</inlineCode>{` automation will create a default group called `}<inlineCode parentName=\"li\">{`fhirUser`}</inlineCode>{` (so that all new users will belong to it), and a Group Membership mapper for adding this group to the access token. This group detail is used to map users to a security-role in the IBM FHIR Server (described below).\n`}<img parentName=\"li\" {...{\n              \"src\": \"https://user-images.githubusercontent.com/5478798/111356103-68e7c680-865e-11eb-8d0c-1c4315a78634.png\",\n              \"alt\": \"Group-Membership-mapper\"\n            }}></img></li>\n          <li parentName=\"ul\">{`The `}<inlineCode parentName=\"li\">{`keycloak-config`}</inlineCode>{` automation does `}<strong parentName=\"li\">{`not`}</strong>{` yet add a mapper for adding the patient parameter to the token response. To support that, add the `}<inlineCode parentName=\"li\">{`User Attribute (with token response support)`}</inlineCode>{` Mapper to the `}<inlineCode parentName=\"li\">{`launch/patient`}</inlineCode>{` scope and configure it to map a user attribute (e.g. `}<inlineCode parentName=\"li\">{`resourceId`}</inlineCode>{`) to the token response.\n`}<img parentName=\"li\" {...{\n              \"src\": \"https://user-images.githubusercontent.com/5478798/111354064-4c4a8f00-865c-11eb-9913-e5931e883175.png\",\n              \"alt\": \"patient-id-mapper\"\n            }}></img></li>\n        </ul>\n      </li>\n      <li parentName=\"ol\">{`Manually define a new `}<em parentName=\"li\">{`Authentication Flow`}</em>{` that requires Audience Validation before login.\n`}<img parentName=\"li\" {...{\n          \"src\": \"https://user-images.githubusercontent.com/5478798/111352797-f75a4900-865a-11eb-9850-302cd3c47973.png\",\n          \"alt\": \"SMART-Authentication-flow\"\n        }}></img></li>\n      <li parentName=\"ol\">{`Add your users and ensure they have a user attribute value that matches the one you mapped in step two.\n`}<img parentName=\"li\" {...{\n          \"src\": \"https://user-images.githubusercontent.com/5478798/111354473-bb27e800-865c-11eb-8432-94e0a647beaa.png\",\n          \"alt\": \"User-attribute\"\n        }}></img></li>\n    </ol>\n    <h3>{`Configuring the IBM FHIR Server`}</h3>\n    <p>{`Now that you have Keycloak configured, its time to hook up the IBM FHIR Server.\nThe IBM FHIR Server supports `}<a parentName=\"p\" {...{\n        \"href\": \"https://openliberty.io/docs/latest/reference/config/server-configuration-overview.html#server-xml\"\n      }}>{`OpenLiberty configDropins`}</a>{` for configuring server behavior. To configure the server to validate Keycloak-issued tokens, modify `}<inlineCode parentName=\"p\">{`configDropins/disabled/jwtRP.xml`}</inlineCode>{` for you Keycloak installation and move it to `}<inlineCode parentName=\"p\">{`configDropins/overrides/`}</inlineCode>{`:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-xml\"\n      }}>{`<server>\n    <!-- Enable features -->\n    <featureManager>\n        <!-- mpJwt-1.1 is already enabled in the default server.xml, but it doesn't hurt to repeat it here -->\n        <feature>mpJwt-1.1</feature>\n    </featureManager>\n\n    <!-- Override the application-bnd binding of the main webapp -->\n    <webApplication contextRoot=\"fhir-server/api/v4\" id=\"fhir-server-webapp\" location=\"fhir-server.war\" name=\"fhir-server-webapp\">\n        <application-bnd id=\"bind\">\n            <security-role id=\"users\" name=\"FHIRUsers\">\n                <group id=\"usersGroup\" access-id=\"group:https://\\${env.HOSTNAME}/auth/realms/\\${env.KEYCLOAK_REALM}/fhirUser\"/>\n            </security-role>\n        </application-bnd>\n    </webApplication>\n\n    <!-- This MP JWT configuration validates JWT access tokens and injects them into\n         ResourceScoped beans for inspection. -->\n    <mpJwt id=\"jwtConsumer\"\n           clockSkew=\"1m\"\n           jwksUri=\"http://keycloak:8080/auth/realms/\\${env.KEYCLOAK_REALM}/protocol/openid-connect/certs\"\n           audiences=\"https://\\${env.HOSTNAME}/fhir-server/api/v4\"\n           userNameAttribute=\"sub\"\n           groupNameAttribute=\"group\"\n           issuer=\"https://\\${env.HOSTNAME}/auth/realms/\\${env.KEYCLOAK_REALM}\"\n           signatureAlgorithm=\"RS256\"\n           authFilterRef=\"filter\"/>\n\n    <authFilter id=\"filter\">\n        <requestUrl urlPattern=\"/fhir-server\" />\n    </authFilter>\n</server>\n`}</code></pre>\n    <p>{`Additionally, to enforce the SMART scopes passed, the server must be configured with the `}<a parentName=\"p\" {...{\n        \"href\": \"https://bintray.com/ibm-watson-health/ibm-fhir-server-releases/fhir-smart\"\n      }}>{`fhir-smart`}</a>{` persistence interceptor (by dropping the jar file into the `}<inlineCode parentName=\"p\">{`userlib`}</inlineCode>{` directory of your IBM FHIR Server installation).`}</p>\n    <p>{`Finaly, to advertise the SMART support and make the auth endpoints discoverable, update the `}<inlineCode parentName=\"p\">{`security`}</inlineCode>{` section of the `}<inlineCode parentName=\"p\">{`fhir-server-config.json`}</inlineCode>{` as described in the `}<a parentName=\"p\" {...{\n        \"href\": \"https://ibm.github.io/FHIR/guides/FHIRServerUsersGuide#533-advertise-the-oauth-endpoints-via-fhir-server-config\"\n      }}>{`IBM FHIR Server User’s Guide`}</a>{`:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-json\"\n      }}>{`...\n    \"security\": {\n      \"cors\": true,\n      \"basic\": {\n        \"enabled\": false\n      },\n      \"certificates\": {\n        \"enabled\": false,\n        \"authFilter\": {\n          \"enabled\": false\n        }\n      },\n      \"oauth\": {\n        \"enabled\": true,\n        \"regUrl\": \"https://<host>/auth/realms/\\${KEYCLOAK_REALM>}/clients-registrations/openid-connect\",\n        \"authUrl\": \"https://<host>/auth/realms/\\${KEYCLOAK_REALM}/protocol/openid-connect/auth\",\n        \"tokenUrl\": \"https://<host>/auth/realms/\\${KEYCLOAK_REALM}/protocol/openid-connect/token\",\n        \"smart\": {\n          \"enabled\": true,\n          \"scopes\": [\"openid\", \"profile\", \"fhirUser\", \"launch/patient\", \"offline_access\",\n            \"patient/*.read\",\n            \"patient/AllergyIntolerance.read\",\n            \"patient/CarePlan.read\",\n            \"patient/CareTeam.read\",\n            \"patient/Condition.read\",\n            \"patient/Device.read\",\n            \"patient/DiagnosticReport.read\",\n            \"patient/DocumentReference.read\",\n            \"patient/Encounter.read\",\n            \"patient/ExplanationOfBenefit.read\",\n            \"patient/Goal.read\",\n            \"patient/Immunization.read\",\n            \"patient/Location.read\",\n            \"patient/Medication.read\",\n            \"patient/MedicationRequest.read\",\n            \"patient/Observation.read\",\n            \"patient/Organization.read\",\n            \"patient/Patient.read\",\n            \"patient/Practitioner.read\",\n            \"patient/PractitionerRole.read\",\n            \"patient/Procedure.read\",\n            \"patient/Provenance.read\",\n            \"patient/RelatedPerson.read\"\n          ],\n          \"capabilities\": [\n            \"sso-openid-connect\",\n            \"launch-standalone\",\n            \"client-public\",\n            \"client-confidential-symmetric\",\n            \"permission-offline\",\n            \"context-standalone-patient\",\n            \"permission-patient\"\n          ]\n        }\n      }\n    },\n...\n`}</code></pre>\n    <h3>{`Conclusion`}</h3>\n    <p>{`In this post, we walked through the OAuth 2.0 extensions defined by SMART App Launch, how to support those extensions via the Alvearie Keycloak Extensions for FHIR, and how to use this project together with the IBM FHIR Server to support SMART App Launch.`}</p>\n    <p>{`SMART App Launch is just one of the specifications defined by SMART-on-FHIR and the authentication and authorization challenges in healthcare are immense. We’d love to hear from members of the FHIR community, the SMART-on-FHIR community, and the Keycloak community on the approach outlined here and where you’d like to see us go next. Please connect with us on `}<a parentName=\"p\" {...{\n        \"href\": \"https://chat.fhir.org/#narrow/stream/179170-smart/topic/Keycloak.20for.20SMART.20authz\"\n      }}>{`chat.fhir.org`}</a>{`, the `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/Alvearie/keycloak-extensions-for-fhir\"\n      }}>{`Keycloak Extensions for FHIR project`}</a>{`, or the `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/ibm/fhir\"\n      }}>{`IBM FHIR Server project`}</a>{` about how we can take this to the next level.`}</p>\n    <hr></hr>\n    <p>{`SMART is a trademark of The Children’s Medical Center Corporation.\nFHIR® is the registered trademark of HL7 and is used with the permission of HL7. Use of the FHIR trademark does not constitute endorsement of this product by HL7.\nIBM and the IBM logo are trademarks of International Business Machines Corporation, registered in many jurisdictions worldwide.\nOther product and service names might be trademarks of IBM or other companies. A current list of IBM trademarks is available on `}<a parentName=\"p\" {...{\n        \"href\": \"https://ibm.com/trademark\"\n      }}>{`https://ibm.com/trademark`}</a>{`.`}</p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      ","// extracted by mini-css-extract-plugin\nmodule.exports = {\"bxTextTruncateEnd\":\"PageTabs-module--bx--text-truncate--end--3BhKg\",\"bxTextTruncateFront\":\"PageTabs-module--bx--text-truncate--front--3k3x1\",\"tabsContainer\":\"PageTabs-module--tabs-container--3ku4u\",\"list\":\"PageTabs-module--list--Zs80A\",\"listItem\":\"PageTabs-module--list-item--UVTiB\",\"link\":\"PageTabs-module--link--TAIyd\",\"selectedItem\":\"PageTabs-module--selected-item--2Kv-J\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"bxTextTruncateEnd\":\"PageHeader-module--bx--text-truncate--end--2SjuB\",\"bxTextTruncateFront\":\"PageHeader-module--bx--text-truncate--front--3jsoz\",\"pageHeader\":\"PageHeader-module--page-header--365gs\",\"darkMode\":\"PageHeader-module--dark-mode--1Y-8D\",\"withTabs\":\"PageHeader-module--with-tabs--2y_Tu\",\"text\":\"PageHeader-module--text--3r6mD\"};"],"sourceRoot":""}